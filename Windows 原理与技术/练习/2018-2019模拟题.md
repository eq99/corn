一、简答题

1.简述在Windows平台下，应用程序有哪些种类？分别有什么特点？

答：

（1）控制台应用程序，特点：运行控制台应用程序时系统会创建控制台终端用于用户交互，交互方式限于字符形式，屏幕利用率极低。

（2）窗体应用程序，特点：使用真彩色图形化输出，支持鼠标定位，能及时响应用户操作，操作方式便利，输出效果绚丽。

（3）动态链接库，特点：不能独立运行，必须由其他运行中的程序调用才可运行。

（4）服务程序，特点：服务程序注册到用户的计算机中，随机器启动并自动执行，用户不能直接运行或终止服务程序；服务程序没有运行界面，也不与用户交互，用户只能通过特殊控制命令使其启动或终止运行。

（5）Web应用程序，特点：基于HTML语言的网页程序，将程序控制语句嵌入在标准的HTML文本中。

 

2.简述具有继承关系的异常类的捕获顺序是什么样的。

多个catch块的捕获顺序是从顶部到底部，对于所引发的每个异常，都只执行一个catch块，如果一系列的catch块所设定的异常类存在继承关系，会按照catch出现的顺序找到匹配的第1个类，并执行其相应的代码，不再执行后续可匹配的异常类。异常是按照最先匹配处理，而不是最佳匹配，如果将捕获基类异常代码写在前面，则基类的代码先被调用而后面的代码则被忽略。

所以编写try语句组时异常类捕获次序应按照类派生的逆序出现，即异常派生类语句写在异常基类之前。

 

3.动态链接库在执行方式上有什么特点？

使用DLL中的函数与程序自身的函数没有区别，DLL有自己的数据段，没有自己的堆栈，使用与调用它的应用程序相同的对堆栈模式，它在运行时需要分配的内存是属于它的进程的，不同程序即使调用相同函数所分配的内存也不会相互影响，DLL函数中的代码所创建的任何对象（包括变量）都归调用它的线程或进程所有。

1个DLL在内存中只有一个实例，系统为每个DLL维护一个线程级引用计数，每当线程载入该DLL，引用计数加1，而程序终止引用计数会变为0（仅指运行时动态链接库），系统会释放DLL占用的虚拟空间。

 

4.反射机制在程序中能起到什么作用？

见ppt---- 2  29页开始

 

 

5.程序的并发与并行的区别是什么？

程序的并行是指两个或多个线程在微观上（事实上）同一时刻在CPU的两个或多个核上运行，只有多核或者多CPU的机器中才能实现。而程序的并发是指多个就绪的线程在Windows平台排列成环形队列，一次分配时间片后运行，此情况下多个线程不在同一时刻运行，而是分享时间片交替运行，程序并发在宏观上表现为并发运行的形式，而在微观上则是串行。

“并发”，是指系统或应用程序在某一时间段内同时处理多个事务的运行过程。对于单处理器的计算机系统来说，由于单个CPU在任何时刻只能执行一个线程，所以，这种计算机系统的并发，实际上是通过操作系统在各个正在执行的线程之间切换CPU，以分时处理的方式实现表面形式上的并发，只是因为其切换的速度快且处理能力强时，用户直观感觉不到而已。

 

6.简述Windows应用程序中的消息机制。

windows具有一个系统消息队列按序存储全部消息，并根据规则将详细投放到进程的消息队列中。系统为每一个窗体对象创建一个消息队列，消息静分配后由系统队列进入到窗体队列，每一个窗体对象配置一个窗体线程运行消息循环任务。消息循环反复检查消息队列中的消息，根据消息值匹配执行相应的分支代码。  消息可以由系统自动派送，也可以由程序主动向其他程序发送，发送方式有两种，一种方式是将消息发送到先进先出消息队列结构中，这些消息也叫队列化消息，另一种方式是将消息直接发送到窗体函数中，这些消息叫非队列化消息。

  驱动程序将用户的键盘与鼠标输入转化为消息结构放入系统消息队列，消息被分配到当前激活的窗体线程，窗体消息处理函数对消息进行匹配。而非队列和的信息则直接发送到了窗体过程。(如果感觉必要请在答卷时加上123页图13-4)。

 

二、综合题

1.结合个人上机实验，讨论COM组件的创建和调用过程，并通过相应的代码示例，展现其过程。

见老师发的源码

 

2.结合个人上机实验，讨论托管动态链接库DLL的创建和调用过程，并通过相应的代码示例，展现其流程。

书P90