# å®‰è£… PostgrsSQL

ï¼ˆ1ï¼‰é…ç½®é•œåƒæº

```shell
ï¼ƒé…ç½®PostgreSQLå®˜æ–¹æº
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
#è…¾è®¯äº‘é•œåƒ
sudo sh -c 'echo "deb https://mirrors.cloud.tencent.com/postgresql/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
#åä¸ºäº‘é•œåƒ
sudo sh -c 'echo "deb https://mirrors.huaweicloud.com/postgresql/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
```

ï¼ˆ2ï¼‰å¯¼å…¥ç­¾åå¯†é’¥ä¸å®‰è£…

```shell
ï¼ƒå¯¼å…¥ç­¾åå¯†é’¥ï¼š
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
ï¼ƒæ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨ï¼š
sudo apt-get update
ï¼ƒå®‰è£…PostgreSQL
sudo apt-get -y install postgresql libpq-dev
```

ï¼ˆ3ï¼‰æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬

```shell
psql --version
```

ï¼ˆ4ï¼‰å…è®¸è¿œç¨‹è¿æ¥

é¦–å…ˆé…ç½® `postgresql.conf`

```shell
$ find / -name "postgresql.conf"
/var/lib/pgsql/9.4/data/postgresql.conf
```

æ‰¾åˆ°

```shell
listen_addresses = 'localhost'
```

æ¢æˆï¼š

```shell
listen_addresses = '*'
```

æ¥ç€é…ç½® `pg_hba.conf`ï¼š

åœ¨æœ€åæ·»åŠ ï¼š

```shell
host    all             all              0.0.0.0/0                       md5
host    all             all              ::/0                            md5
```

å‚è€ƒåšå®¢ï¼šhttps://www.bigbinary.com/blog/configure-postgresql-to-allow-remote-connection

# å®‰è£… pgAdmin4

ï¼ˆ1ï¼‰å®‰è£… key:

```shell
sudo curl https://www.pgadmin.org/static/packages_pgadmin_org.pub | sudo apt-key add
```

ï¼ˆ2ï¼‰é…ç½®é•œåƒæºï¼š

```shell
# é…ç½®pgAdminå®˜æ–¹æº
sudo sh -c 'echo "deb https://ftp.postgresql.org/pub/pgadmin/pgadmin4/apt/$(lsb_release -cs) pgadmin4 main" > /etc/apt/sources.list.d/pgadmin4.list && apt update'
#è…¾è®¯äº‘é•œåƒ
sudo sh -c 'echo "deb https://mirrors.cloud.tencent.com/postgresql/pgadmin/pgadmin4/apt/$(lsb_release -cs) pgadmin4 main" > /etc/apt/sources.list.d/pgadmin4.list && apt update'
#åä¸ºäº‘é•œåƒ
sudo sh -c 'echo "deb https://mirrors.huaweicloud.com/postgresql/pgadmin/pgadmin4/apt/$(lsb_release -cs) pgadmin4 main" > /etc/apt/sources.list.d/pgadmin4.list && apt update'
```

ï¼ˆ3ï¼‰å®‰è£…:

```shell
# å®‰è£…pgAdmin4(æ¡Œé¢å’ŒwebåŒæ¨¡å¼)
sudo apt install pgadmin4

# å®‰è£…pgAdmin4-desktop(æ¡Œé¢å•æ¨¡å¼)
sudo apt install pgadmin4-desktop

# å®‰è£…pgAdmin4-web(webå•æ¨¡å¼)
sudo apt install pgadmin4-web 
# å¦‚æœå·²å®‰è£…pgadmin4-webå•æ¨¡å¼ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤:
sudo /usr/pgadmin4/bin/setup-web.sh
```

å‚è€ƒæ–‡ç« ï¼šhttps://www.huoxiaoqiang.com/basic/sql/3217.html

# PostgreSQL å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤                                                         | æè¿°                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `sudo su - postgres`                                         | åˆ‡æ¢åˆ°æ•°æ®åº“ç”¨æˆ·                                             |
| `psql`                                                       | ç™»å½• PostgreSQL æ§åˆ¶å°                                       |
| `\password postgres`                                         | ä¸º postgres ç”¨æˆ·è®¾ç½®ä¸€ä¸ªå¯†ç                                  |
| `CREATE USER freeoadbuser WITH PASSWORD 'password';`         | åˆ›å»ºæ•°æ®åº“ç”¨æˆ·freeoadbuserï¼Œå¹¶è®¾ç½®å¯†ç                        |
| `CREATE DATABASE freeoadb OWNER freeoadbuser;`               | åˆ›å»ºç”¨æˆ·æ•°æ®åº“ï¼Œè¿™é‡Œä¸ºfreeoadbï¼Œå¹¶æŒ‡å®šæ‰€æœ‰è€…ä¸ºfreeoadbuser   |
| `GRANT ALL PRIVILEGES ON DATABASE freeoadb to freeoadbuser;` | å°†freeoadbæ•°æ®åº“çš„æ‰€æœ‰æƒé™éƒ½èµ‹äºˆfreeoadbuser,å¦åˆ™freeoadbuseråªèƒ½ç™»å½•æ§åˆ¶å°ï¼Œæ²¡æœ‰ä»»ä½•æ•°æ®åº“æ“ä½œæƒé™ |
| `psql -U freeoadbuser -d freeoadb -h 127.0.0.1 -p 5432`      | æ·»åŠ æ–°ç”¨æˆ·å’Œæ–°æ•°æ®åº“ä»¥åï¼Œä»¥æ–°ç”¨æˆ·çš„åä¹‰ç™»å½•æ•°æ®åº“ï¼Œä¼šæç¤ºè¾“å…¥å¯†ç  |
| `\l`                                                         | åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“                                               |
| `\?`                                                         | æŸ¥çœ‹psqlå‘½ä»¤åˆ—è¡¨ã€‚                                           |
| `\c [database_name]`                                         | ä½¿ç”¨æŒ‡å®šæ•°æ®åº“                                               |
| `\d`                                                         | åˆ—å‡ºå½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨æ ¼ã€‚                                   |
| `\d [table_name]`                                            | åˆ—å‡ºæŸä¸€å¼ è¡¨æ ¼çš„ç»“æ„                                         |
| `\du`                                                        | åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·                                                 |
| `\conninfo`                                                  | åˆ—å‡ºå½“å‰æ•°æ®åº“å’Œè¿æ¥çš„ä¿¡æ¯ã€‚                                 |

å‚è€ƒæ–‡ç« ï¼šhttp://www.freeoa.net/osuport/db/postgresql-comm-used-cmd-refer_3072.html

# å®‰è£… Diesel cli

[Diesel](https://diesel.rs/) æ˜¯ Rust è¯­è¨€çš„ ORM åº“ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ï¼Œç°åœ¨æˆ‘ä»¬åœ¨ Windows 10 ä¸Šå®‰è£…å®ƒçš„ cli å·¥å…·ã€‚

ğŸ”‘ ä» https://www.enterprisedb.com/download-postgresql-binaries ä¸‹è½½ç›¸åº”çš„åŒ…ï¼Œè§£å‹å¤‡ç”¨ã€‚

ğŸ”‘ æ‰“å¼€ `cmd` ï¼Œè¿è¡Œï¼š

```shell
$ set PQ_LIB_DIR=C:\Program Files\PostgreSQL\14\lib
$ cargo install diesel_cli --no-default-features --features postgres
```

æ³¨æ„é‚£ä¸ªè·¯å¾„è¦æ¢æˆä½ è‡ªå·±çš„ã€‚

ğŸ”‘ ä»ä¸‹è½½çš„ `PostgreSQL\bin` ç›®å½•ä¸­æ‹·è´å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶åˆ°ï¼š`$HOME\.cargo\bin` ä¸­ï¼š

```shell
# https://github.com/diesel-rs/diesel/issues/1883#issuecomment-583946727
libcrypto-1_1.dll
libiconv-2.dll
libintl-8.dll
libpq.dll
libssl-1_1.dll
```

ğŸ”‘ æœ€åè¿è¡Œæµ‹è¯•ï¼š

```shell
$ diesel
```



å‚è€ƒæ–‡ç« ï¼š

ï¼ˆ1ï¼‰https://blog.51cto.com/u_15060533/4112387

ï¼ˆ2ï¼‰https://luckystreak.ca/writing/fixing_diesel_cli_rust_build_error.html

