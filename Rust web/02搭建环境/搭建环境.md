ğŸ’æœ¬ç« è¦ç‚¹ï¼š

- æ„å»ºé¡¹ç›®
- æ¨¡æ¿å¼•æ“
- é™æ€æ–‡ä»¶

# æ„å»ºé¡¹ç›®

ğŸ”‘ æ–°å»ºä¸€ä¸ª GitHub ä»“åº“ï¼šcrabï¼Œå¹¶å…‹éš†åˆ°æœ¬åœ°ã€‚

ğŸ”‘ ç”¨ VSCode æ‰“å¼€ crabï¼Œæ–°å»º`Cargo.toml`æ–‡ä»¶ï¼š

```toml
[package]
name = "crab"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
tide = "0.16.0"
async-std = { version = "1.8.0", features = ["attributes"] }
serde = { version = "1.0", features = ["derive"] }
```

ğŸ”‘ æ–°å»ºæ–‡ä»¶å¤¹ `src`ï¼Œåœ¨é‡Œé¢æ–°å»ºæ–‡ä»¶ `main.rs`ï¼š

```rust
use tide::prelude::*;
use tide::Request;

#[async_std::main]
async fn main() -> tide::Result<()> {
    tide::log::start();
    let mut app = tide::new();
    app.at("/").get(home);
    app.listen("127.0.0.1:8080").await?;
    Ok(())
}

async fn home(req: Request<()>) -> tide::Result {
    Ok("Hello, Rust!".into())
}
```

ğŸ”‘ è¿è¡Œç¨‹åºï¼š`cargo run`ï¼Œæ‰“å¼€æµè§ˆå™¨å°±å¯ä»¥çœ‹åˆ° `Hello, Rust!`ã€‚

ğŸ“è¦ç‚¹è§£è¯»ï¼š

- æˆ‘ä»¬é€‰ç”¨ [tide](https://crates.io/crates/tide) æ¡†æ¶ï¼Œå»ºè®®ç”¨ `tide = "0.16.0"` è¿™ä¸ªç‰ˆæœ¬å­¦ä¹ ï¼Œä¸ç„¶ä¼šå‡ºç°å…¼å®¹æ€§é—®é¢˜ã€‚
- ä»£ç å¾ˆæ¸…æ™°æ˜“æ‡‚ï¼šå®ç°äº†ä¸€ä¸ªç®€å•çš„è·¯ç”±å¤„ç†å‡½æ•° `home` å¤„ç†é¦–é¡µ `get` è¯·æ±‚ã€‚
- ç¼–å†™ web ç¨‹åºéœ€è¦é¢‘ç¹çš„æ”¹åŠ¨å¹¶æŸ¥çœ‹ç»“æœï¼Œé…ç½®è‡ªåŠ¨é‡æ–°ç¼–è¯‘å·¥å…· [cargo-watch](https://crates.io/crates/cargo-watch)ï¼š

```shell
cargo install cargo-watch
cargo watch -x run
```

# ä½¿ç”¨æ¨¡æ¿å¼•æ“

ç›®å‰ web å¼€å‘æœ‰ä¸¤ç§åŸºæœ¬æ¨¡å¼ï¼šå‰åç«¯åˆ†ç¦»æ¨¡å¼å’Œæ¨¡æ¿æ¸²æŸ“æ¨¡å¼ã€‚

å‰åç«¯åˆ†ç¦»æ¨¡å¼æŠŠ UI é€»è¾‘ä¸æ•°æ®é€»è¾‘åˆ†å¼€ï¼Œéœ€è¦å»ºç«‹å‰ç«¯ä¸åç«¯ä¸¤ä¸ªé¡¹ç›®ï¼Œé€‚åˆæ„å»ºæ•°æ®å¯†é›†å‹ä¸äº¤äº’å¯†é›†å‹åº”ç”¨ï¼Œé€‚åˆå›¢é˜Ÿåˆä½œã€‚

æ¨¡æ¿æ¸²æŸ“æ¨¡å¼ç›´æ¥è¿”å› HTML é¡µé¢ï¼Œä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç‰¹åˆ«é€‚åˆä¸ªäººå¼€å‘è€…ï¼›ç¼ºç‚¹æ˜¯éš¾ä»¥æ„å»ºæ•°æ®å¯†é›†å‹ä¸äº¤äº’å¯†é›†å‹åº”ç”¨ã€‚

 ğŸ”‘ æ·»åŠ æ¨¡æ¿å¼•æ“ä¾èµ–ï¼š

```toml
tera = "1.6.1"
tide-tera = "0.2.4"
```

ğŸ”‘ é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š`templates`ï¼Œåœ¨é‡Œé¢æ·»åŠ æ–‡ä»¶ï¼š`home.html`ï¼š

```html
<!DOCTYPE html>
<html lang="zh">

<head>
    <title>èŸ¹è€æ¿çš„åšå®¢</title>
</head>

<body>
    <h1>{{ hello }}ï¼Œæ¬¢è¿æ¥åˆ°èŸ¹è€æ¿çš„åšå®¢ã€‚</h1>
</body>

</html>
```
ğŸ”‘ ä¿®æ”¹ `src/main.rs` ï¼š
```rust
use tera::Tera;
use tide::prelude::*;
use tide::Request;
use tide_tera::prelude::*;

#[async_std::main]
async fn main() -> tide::Result<()> {
    tide::log::start();
    let tera = Tera::new("templates/**/*")?;

    let mut app = tide::with_state(tera);
    app.at("/").get(home);
    app.listen("127.0.0.1:8080").await?;
    Ok(())
}

async fn home(req: Request<Tera>) -> tide::Result {
    let tera = req.state();
    let hello = "ä½ å¥½";
    tera.render_response("home.html", &context! { "hello" => hello })
}
```

ğŸ”‘ è¿è¡Œï¼š`cargo watch -x run`ã€‚

ğŸ“è¦ç‚¹è§£è¯»ï¼š

- [Tera](https://tera.netlify.app/docs/) æ˜¯ Rust è¯­è¨€çš„æ¨¡æ¿å¼•æ“ï¼Œç±»ä¼¼ Python è¯­è¨€çš„ `Jinja2` å’Œ `Django templates`ã€‚å¦‚æœä½ æ²¡æœ‰è¿™æ–¹é¢çš„ç»éªŒï¼Œå»ºè®®é˜…è¯»å®ƒçš„æ–‡æ¡£ã€‚
- `    <h1>{{ hello }}ï¼Œæ¬¢è¿æ¥åˆ°èŸ¹è€æ¿çš„åšå®¢ã€‚</h1>` ä¸ `    tera.render_response("home.html", &context! { "hello" => hello })` å¯¹åº”äº†å˜é‡ï¼š`hello`ã€‚
- æ³¨æ„ `let tera = Tera::new("templates/**/*")?;` çš„è·¯å¾„ä¸è¦å¼„é”™äº†ã€‚

# é™æ€æ–‡ä»¶

æ‰€è°“çš„é™æ€æ–‡ä»¶ä¸€èˆ¬æŒ‡çš„æ˜¯ç½‘ç«™ LOGOï¼ŒCSSï¼ŒJS ç­‰æ–‡ä»¶ã€‚ 

 ğŸ”‘ æ–°å»ºæ–‡ä»¶ `templates/layout.html`ï¼š

```html
<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="shortcut icon" href="/public/favicon.svg" />
    {% block head %}
    {% endblock head %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"
        integrity="sha256-hFAmQt2dGk6G99nu2cEWz8/1JGRnBP/BsGoZwQ7WeLE=" crossorigin="anonymous">
    <link rel="stylesheet" href="/public/css/main.css">
</head>

<body class="container-fluid">
    <div class="stiky-footer">
        {#################################################################}
        {# header component #}
        {#################################################################}
        <header>
            <nav class="navbar navbar-expand-md navbar-light bg-light rounded" aria-label="navbar">
                <div class="container-fluid">
                    <a class="navbar-brand" href="/">èŸ¹è€æ¿çš„åšå®¢</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false"
                        aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse row" id="navbarContent">

                        <ul class="nav justify-content-end">
                            <li class="nav-item">
                                <a class="btn btn-outline-secondary me-2" aria-current="page" href="/login">ç™»å½•</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>

        {#################################################################}
        {# main component #}
        {#################################################################}
        <main>
            {% block main %}
            {% endblock main %}
        </main>
    </div>


    {#################################################################}
    {# footer component #}
    {#################################################################}
    <footer class="stiky-footer-height">
        <hr class="my-3">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <span class="link-secondary mx-1">
                    Â© 2021
                    <a class="link-secondary" href="https://lookelooke.com">èŸ¹è€æ¿çš„åšå®¢</a>
                </span>
                <span class="mx-1">
                    <a class="link-secondary" href="https://beian.miit.gov.cn/">é„‚ICPå¤‡xxxxxxxxxå·-x</a>
                </span>
                <a class="link-secondary mx-1" href="#">å…³äºæˆ‘ä»¬</a>
                <a class="link-secondary mx-1" href="#">æ„è§åé¦ˆ</a>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"
        integrity="sha256-+EWBEj6A8lxFvckkChitv8/RcHK/PcWvQV+D7PDflC8=" crossorigin="anonymous" async></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/plugins/autoloader/prism-autoloader.min.js"></script>
    {% block script %}
    {% endblock script %}
    <script src="/public/js/main.js" async></script>
</body>

</html>
```

 ğŸ”‘ ä¿®æ”¹ `templates.home.html`ï¼š

```html
{% extends "layout.html" %}


{% block head %}
<title>èŸ¹è€æ¿çš„åšå®¢</title>
{% endblock head %}

{% block main %}
<h1>{{ hello }}ï¼Œæ¬¢è¿æ¥åˆ°èŸ¹è€æ¿çš„åšå®¢ã€‚</h1>
{% endblock main %}
```

ğŸ“è¦ç‚¹è§£è¯»ï¼š

- å…³äº `{% block head %}` ï¼šå¯¹æ¯”ä¸Šä¸‹ä¸¤ä¸ª `html` ä½ ä¼šå‘ç°å®ƒçš„ä½œç”¨æ˜¯å®šä¹‰äº†ä¸€ä¸ªæ‰©å±•ç‚¹ã€‚
- å…³äº `{# header component #}`ï¼šæ³¨é‡Šã€‚

- ä» `layout` çš„ç»“æ„æ¥çœ‹ï¼Œæˆ‘ä»¬æ·»åŠ äº†å¸¸ç”¨çš„å‰ç«¯ç»„ä»¶ï¼š

ï¼ˆ1ï¼‰`bootstrap` ï¼šCSS åº“

ï¼ˆ2ï¼‰`jquery`ï¼šç®€åŒ– JS æ“ä½œçš„åº“

ï¼ˆ3ï¼‰`fortawesome`ï¼šå›¾æ ‡åº“

ï¼ˆ4ï¼‰`katex` ï¼šæ•°å­¦å…¬å¼æ¸²æŸ“

ï¼ˆ5ï¼‰`prismjs`ï¼šä»£ç é«˜äº®

- éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

`<link rel="shortcut icon" href="/public/favicon.svg" />`

`<link rel="stylesheet" href="/public/css/main.css">`

`<script src="/public/js/main.js" async></script>`

è¿™ä¸‰ä¸ªæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬è‡ªå·±çš„é™æ€æ–‡ä»¶ã€‚

ğŸ”‘ æ–°å»ºæ–‡ä»¶å¤¹ï¼š`public/css`ï¼Œæ·»åŠ æ–‡ä»¶ï¼š`public/css/main.css`:

```css
/* begin stiky-footer é¡µè„šæ²‰åº•
* https://css-tricks.com/couple-takes-sticky-footer/ 
*/
.stiky-footer {
    min-height: calc(100vh - 80px);
}

.stiky-footer-height {
    height: 60px;
}
/* end stiky-footer */
```

ğŸ”‘ æ–°å»ºæ–‡ä»¶å¤¹ï¼š`public/js`ï¼Œæ·»åŠ æ–‡ä»¶ï¼š`public/js/main.js` å¤‡ç”¨ã€‚

ğŸ”‘ ä» [Rust å®˜ç½‘](https://www.rust-lang.org/) æŠŠ logo å¦å­˜ä¸ºåˆ° `public` æ–‡ä»¶ä¸‹ï¼Œæ–‡ä»¶åä¸º `favicon.svg`ã€‚

ğŸ”‘ ä¿®æ”¹ `src/main.rs`ï¼š

```rust
use tera::Tera;
use tide::prelude::*;
use tide::Request;
use tide_tera::prelude::*;

#[async_std::main]
async fn main() -> tide::Result<()> {
    tide::log::start();
    let tera = Tera::new("templates/**/*")?;

    let mut app = tide::with_state(tera);
    app.at("/").get(home);
    app.at("/public").serve_dir("public/")?;
    app.listen("127.0.0.1:8080").await?;
    Ok(())
}

async fn home(req: Request<Tera>) -> tide::Result {
    let tera = req.state();
    let hello = "ä½ å¥½";
    tera.render_response("home.html", &context! { "hello" => hello })
}
```

æˆ‘ä»¬æ·»åŠ äº†ä¸€è¡Œï¼š`app.at("/public").serve_dir("public/")?;`

ğŸ”‘ è¿è¡Œï¼Œæ‰“å¼€æµè§ˆå™¨å¾—åˆ°æœ€ç»ˆæ•ˆæœï¼š

![image-20211109124708962](image-20211109124708962.png)

ğŸ“è¦ç‚¹è§£è¯»ï¼š

- è¦ç‰¹åˆ«æ³¨æ„ `app.at("/public").serve_dir("public/")?;` ä¸¤è¾¹è·¯å¾„çš„å¯¹åº”å…³ç³»ã€‚
- å¯ä»¥ä½¿ç”¨ `Ctrl+F5` åˆ·æ–°æµè§ˆå™¨ç¼“å­˜ã€‚

# å°ç»“

æˆ‘ä»¬å·²ç»å®Œæˆäº†åšå®¢ç½‘ç«™æ¡†æ¶çš„æ­å»ºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å®ç°ç½‘ç«™åŠŸèƒ½ã€‚

â“ æ€è€ƒï¼šRust è¯­è¨€çš„ç›¸å¯¹è·¯å¾„æ˜¯å¦‚ä½•ç¡®å®šçš„ï¼Ÿ

